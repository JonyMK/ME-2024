#########################################################################
######################## Capítulo 2 - Exercícios ########################
#########################################################################

#######################################################
#################### Exercicio 2.4 ####################
#######################################################

############################################
###  x   ###  0  ###  1  ###  2  ###  3  ###
############################################
### f(x) ### 1/8 ### 1/4 ### 1/2 ### 1/8 ###
############################################

##############
##### 1) #####
##############

# f(x) >= 0, ∀x ?

# f(0) = 1/8 >= 0
# f(1) = 1/4 >= 0
# f(2) = 1/2 >= 0
# f(3) = 1/8 >= 0

# Σ f(x) = 1 ?

(1/8 + 1/4 + 1/2 + 1/8) # = 1

# f(x) é função de probabilidade, para x < 0 = 0, x > 3 = 0,
# e x = [0, 1, 2, 3] como está representado.

##############
##### 2) #####
##############

#        I 0    , x < 0     
#        I 1/8  , 0 <= x < 1
# F(x) = I 3/8  , 1 <= x < 2 
#        I 7/8  , 2 <= x < 3
#        I 8/8  , x >= 3

##############
##### 3) #####
##############

# P(0 <= x < 2) <=>
# P(-1 < x < 2) <=>
# P(-1 < x <= 1) <=>
# F(1) - F(-1) <=>
# 3/8 - 0 <=>
# 3/8

##############
##### 4) #####
##############

# E[X] = Σ x*f(x)
((0*(1/8))+(1*(1/4))+(2*(1/2))+(3*(1/8))) # = 1.625
# E[X] = 1.625

# E[X+2] = E[X] + 2 <=>
# E[X+2] = 1.625 + 2 <=>
# E[X+2] = 3.625

# E[-X+2] = -1 * E[X] + 2 <=>
# E[X+2] = -1 * 1.625 + 2 <=>
# E[X+2] = 0.375

##############
##### 5) #####
##############

# V[X] = E[X^2] - E^2[X]

# E[X^2] = Σ x^2 * f(x)
(((0^2)*(1/8))+((1^2)*(1/4))+((2^2)*(1/2))+((3^2)*(1/8))) # = 3.375
# E[X^2] = 3.375

# E^2[X] = 1.625^2
(1.625^2) # = 2.640625
# E^2[X] = 2.6406

# V[X] = E[X^2] - E^2[X] <=>
# V[X] = 3.375 - 2.6406 <=>
(3.375 - 2.6406) # = 0.7344
# V[X] = 0.7344

# V[2X+1] = 2^2 * V[X] <=>
# V[2X+1] = 4 * 0.7344 <=>
(4 * 0.7344) # = 2.9376
# V[2X+1] = 2.9376

# V[-2X+1] = (-2)^2 * V[X] <=>
# V[-2X+1] = 4 * 0.7344 <=>
(4 * 0.7344) # = 2.9376
# V[-2X+1] = 2.9376

#######################################################
#################### Exercicio 2.5 ####################
#######################################################

##############################################
###  x   ### 1 - 2k ### k - 1 ### k ### 2k ###
##############################################
### f(x) ###   p   ###   3p   ### p ###  p ###
##############################################

##############
##### 1) #####
##############

# E[X] = 1/3
# p = ? = 1/6
# k = ? = 1

# Σf(x) = 1 <=> 6p = 1 <=> p = 1/6

# E[X] = 1/3 <=>
# ((1 - 2k) / 6) + ((3k - 3) / 6) + k/6 + 2k/6 = 1/3 <=>
# ((1 - 2k + 3k - 3 + k + 2k) / 6) = 1/3 <=>
# ((-2 + 4k) / 6) = 1/3 <=>
# 4k/6 = 1/3 + 2/6 <=>
# 4k/6 = 4/6 <=>
# 4k = 4/6 * 6 <=>
# 4k = 24/6 <=>
# k = 24/6 / 4 <=>
# k = 24/24 <=>
# k = 1

##############
##### 2) #####
##############

############################################
###  x   ###  -1 ###  0  ###  1  ###  2  ###
############################################
### f(x) ### 1/6 ### 3/6 ### 1/6 ### 1/6 ###
############################################

# V[X] = ?

# E^2[X] = (1/3)^2 = 1/9

# E[X^2] = ((-1)^2 * 1/6) + (0^2 * (3/6)) + (1^2 * (1/6)) + (2^2 * (1/6))
((-1)^2 * 1/6) + (0^2 * (3/6)) + (1^2 * (1/6)) + (2^2 * (1/6))
# E[X^2] = 1

# V[X] = E[X^2] - E^2[X] <=>
# V[X] = 1 - 1/9 <=>
# V[X] = 8/9

##############
##### 3) #####
##############

# E[3X+5] = ? = 6
# V[3X+5] = ? = 8
# E[1-2X] = ? = 1/3
# V[1-2X] = ? = 32/9

# E[3X+5] = 3 * E[X] + 5 <=>
# E[3X+5] = 3 * 1/3 + 5 <=>
# E[3X+5] = 1 + 5 <=>
# E[3X+5] = 6

# V[3X+5] = 3^2 * V[X] <=>
# V[3X+5] = 9 * 8/9 <=>
# V[3X+5] = 72/9 <=>
# V[3X+5] = 8

# E[1-2X] = -2 * E[X] + 1 <=>
# E[1-2X] = -2 * 1/3 + 1 <=>
# E[1-2X] = -2/3 + 1 <=>
# E[1-2X] = 1/3

# V[1-2X] = (-2)^2 * V[X] <=>
# V[1-2X] = 4 * 8/9 <=>
# V[1-2X] = 32/9

#######################################################
#################### Exercicio 2.6 ####################
#######################################################

#        | 0    , x < 0
#        | 1/8  , 0 <= x < 1
# F(x) = | 1/2  , 1 <= x < 2
#        | 7/8  , 2 <= x < 3
#        | 1    , x >= 3

##############
##### 1) #####
##############

############################################
###  x   ###  0  ###  1  ###  2  ###  3  ###
############################################
### f(x) ### 1/8 ### 3/8 ### 3/8 ### 1/8 ###
############################################

# Condição 1: f(x) >= 0, ∀x ?

# f(0) = 1/8 >= 0
# f(1) = 3/8 >= 0
# f(2) = 3/8 >= 0
# f(3) = 1/8 >= 0

# Condição 2: Σ f(x) = 1 ?

(1/8 + 3/8 + 3/8 + 1/8) # = 1
# Σ f(x) = 1

##############
##### 2) #####
##############

########
## A) ##
########

FRACTION::fra(7/8 - 1/8)
# P(0 < X <= 2) = F(2) - F(0) = 7/8 - 1/8 = 6/8 = 3/4

########
## B) ##
########

FRACTION::fra(7/8 - 0)
# P(0 <= X <= 2) = P(-1 < X <= 2) = F(2) - F(-1) = 7/8 - 0 = 7/8

########
## C) ##
########

FRACTION::fra(1/2 - 0)
# P(0 <= X < 2) = P(-1 < X < 2) = P(-1 < X <= 1) = F(1) - F(-1) = 1/2 - 0 = 1/2

########
## D) ##
########

FRACTION::fra(1/2 - 1/8)
# P(0 < X < 2) = P(0 < X <= 1) = F(1) - F(0) = 1/2 - 1/8 = 3/8

########
## E) ##
########

# P(X < 4) = P(X <= 3) = F(3) = 1

########
## F) ##
########

FRACTION::fra(1 - 1/2)
# P(X > 1) = 1 - P(<= 1) = 1 - F(1) = 1 - 1/2 = 1/2

##############
##### 3) #####
##############

# E[X] = ?
# V[X] = ?

# E[X] = Σ x*f(x)
((0 * (1/8)) + (1 * (3/8)) + (2 * (3/8)) + (3 * (1/8))) # = 1.5
FRACTION::fra(1.5)
# E[X] = 3/2

# V[X] = E[X^2] - E^2[X]

FRACTION::fra((3/2)^2)
# E^2[X] = (3/2)^2 = 9/4

# E[X^2] = Σ x^2 * f(x)
(((0^2) * (1/8)) + ((1^2) * (3/8)) + ((2^2) * (3/8)) + ((3^2) * (1/8))) # = 3
# E[X^2] = 3

# V[X] = E[X^2] - E^2[X] <=>
# V[X] = 3 - 9/4 <=>
# V[X] = 12/4 - 9/4 <=>
# V[X] = 3/4

#######################################################
#################### Exercicio 2.8 ####################
#######################################################

# Dx = [0, 100]

##############
##### 1) #####
##############

# n = 100 - 0 + 1

# f(x) = 1/n = 1/101

##############
##### 2) #####
##############

library(MASS)
# P(X <= 94 | X > 32) <=>
# P(X <= 94 ^ X > 32) / P(X > 32) <=>
# P(32 < X <= 94) / P(X > 32) <=>
# (F(94) - F(32)) / (1 - P(X <= 32)) <=>
# (95/101 - 33/101) / (1 - F(32)) <=>
fractions((95/101) - (33/101))
# 62/101 / (1 - 33/101) <=>
fractions(1 - (33/101))
# 62/101 / 68/101 <=>
fractions((62/101) / (68/101))
# 31/34

##############
##### 3) #####
##############

# Dx - Conjunto de inteiros consecutivos

# E[X] = (a + b) / 2 = (100 + 0) / 2 = 50

((101^2)-1)/12
# V[X] = ((b - a + 1)^2 - 1) / 12 = (101^2 - 1) / 12 = 850

sqrt(850)
# o = sqrt(V[X]) = sqrt(850) = 29.15476

########################################################
#################### Exercicio 2.10 ####################
########################################################

# Dx = [0, 35]

##############
##### 1) #####
##############

# X = 5Y

# Dy = [0, 1, 2, 3, 4, 5, 6, 7]

# f(x) = 1/n

# n = (b - a + 1) = 8

# f(x) = 1/8

##############
##### 2) #####
##############

# E[X] = E[5Y] = 5 * E[Y] = 5 * ((0 + 7) / 2)
fractions((5 * ((0 + 7) / 2)))
# E[X] = 35/2

# V[X] = V[5Y] = 5^2 * V[Y] = 25 * (((7 - 0 + 1)^2 - 1) / 12)
fractions(25 * (((7 - 0 + 1)^2 - 1) / 12))
# V[X] = 525/4

# o = sqrt(V[X])
sqrt(25 * (((7 - 0 + 1)^2 - 1) / 12))
# o = 11.45644

##############
##### 3) #####
##############

# P(X <= E[X] | X >= 5) =
# P(X <= 35/2 | X >= 5) =
# P(X <= 35/2 ^ X >= 5) / P(X >= 5) =
# P(5 <= X <= 35/2) / P(X >= 5) =
# P(4 < X <= 35/2) / (1 - P(X < 5)) =
# (F(35/2) - F(4)) / (1 - P(X <= 4)) =
# (F(35/2) - F(4)) / (1 - F(4)) =
# (1/2 - 1/8) / (1 - 1/8) =
# 3/8 / 7/8 =
fractions((3/8) / (7/8))
# 3/7

########################################################
#################### Exercicio 2.12 ####################
########################################################

# X - Nº de indivíduos observados que morrem da doença.

##############
##### 1) #####
##############

# Sucesso - Morrer da doença

# X ~ B(n, p)

# n -> 8
# p = 10% = 0.1

# X ~ B(8, 0.1)

##############
##### 2) #####
##############

# P(X <= 3) = F(3) = pbinom(3, 8, 0.1) = 0.9950
pbinom(3, 8, 0.1) # = 0.9950

##############
##### 3) #####
##############

#### SEM NOVA VARIÁVEL

# P(sobreviverem pelo menos 6) =
#   P(morrerem no máximo 2) =
#   P(X <= 2)=
#   F(2) =
#   pbinom(2, 8, 0.1) =
pbinom(2, 8, 0.1) # = 0.9619082
# 0.9619

# P(sobreviverem exatamente 5) =
# P(morrerem exatamente 3) =
# P(X = 3) =
# dbinom(5, 8, 0.1) =
dbinom(3, 8, 0.1) # = 0.03306744
# = 0.0331

#### COM NOVA VARIÁVEL

# Y - Nº de indivíduos observados que sobrevivem da doença.
# Sucesso - Sobreviver da doença

# Y ~ B(n, p)

# n -> 8
# p = 90% = 0.9

# Y ~ B(8, 0.9)

# P(sobreviverem pelo menos 6) =
# P(Y >= 6) =
# 1 - P(Y < 6)=
# 1 - P(Y <= 5) =
# 1 - F(5) =
# 1 - pbinom(5, 8, 0.9) =
1 - pbinom(5, 8, 0.9) # = 0.9619082
# 0.9619

# P(Y = 5) = f(5) = dbinom(5, 8, 0.9) = 0.0331
dbinom(5, 8, 0.9) # = 0.03306744

##############
##### 4) #####
##############

# Nr esperado de sobreviventes = 8 * 0.9 = 7.2
# 0.1 -> 10% dos casos pode ser mortal, logo:
# 0.9 -> 90% dos casos pode sobreviver.

########################################################
#################### Exercicio 2.13 ####################
########################################################

# X - A integração de uma região europeia ter reflexos positivos.
# P(sucesso) - Ter reflexos poitivos.
# n = ?
# p = 60% da região tem reflexos positivos = 0.6

# X ~ B(n, 0.6)

##############
##### 1) #####
##############

# n = 12 -> 12 pessoas da região

# X ~ B(12, 0.6)

# P(X = 5) = f(5) = dbinom(5, 12, 0.6) = 0.1010
dbinom(5, 12, 0.6) # = 0.1009024

##############
##### 2) #####
##############

# Y - A integração de uma região europeia ter reflexos negativos.
# P(sucesso) - Ter reflexos negativos.
# n = 12
# p = 25% da região tem reflexos negativos = 0.25

# Y ~ B(12, 0.25)

# P(Y < 3) = P(Y <= 2) = F(2) = pbinom(2, 12, 0.25) = 0.3907
pbinom(2, 12, 0.25) # = 0.390675

##############
##### 3) #####
##############

# T - A integração de uma região europeia ter reflexos negativos.
# P(sucesso) - Ter reflexos negativos.
# n = 80
# p = 25% da região tem reflexos negativos = 0.25

# T ~ B(80, 0.25)

# E[T] = n*p = 80 * 0.25 = 20
(80 * 0.25)

########################################################
#################### Exercicio 2.17 ####################
########################################################

# X - Nº de sementes, por fruto.
# E[X] = 7
# X ~ P(λ)
# λ = V[X] = E[X] = 7
# X ~ P(7)

##############
##### 1) #####
##############

# P(X = 20) = f(20) = dpois(20, 7) = 0.00003
dpois(20, 7) # = 2.990713e-05

##############
##### 2) #####
##############

 # P(X < 2) = P(X <= 1) = F(1) = ppois(1, 7) = 0.0073
ppois(1, 7) # = 0.007295056

########################################################
#################### Exercicio 2.18 ####################
########################################################

# X - Nº de chamadas telefónicas recebidas, num dia.
# X ~ P(λ)
# λ = 5
# X ~ P(5)

##############
##### 1) #####
##############

# Dado que a distribuição é Poisson, e o parâmetro λ é 5:
# Sabendo que λ = E[X] = V[X]:
# E[X] = 5
# V[X] = 5

##############
##### 2) #####
##############

# P(X = 0) = f(0) = dpois(0, 5) = 0.0067
dpois(0, 5) # = 0.006737947

##############
##### 3) #####
##############

# P(5 <= X <= 8) =
# P(4 < X <= 8) =
# F(8) - F(4) =
# ppois(8, 5) - ppois(4, 5) =
# 0.4914
ppois(8, 5) - ppois(4, 5) # = 0.4914131

##############
##### 4) #####
##############

# Dado que:
# X - Nº de chamadas telefónicas recebidas, num dia.
# X ~ P(5)
# E que o fim de semana tem 2 dias, obtém-se:

# X1 - Nº de chamadas telefónicas recebidas, no sábado.
# X2 - Nº de chamadas telefónicas recebidas, no domingo.

# Y - Nº de chamadas telefónicas recebidas, em dois dias (fim de semana).
# Y = X1 + X2
# λ = λX1 + λX2 = 5 (ciclo de sábado) + 5 (ciclo de domingo) = 10
# Y ~ P(10)

# P(10 < Y < 12) = P(Y = 11) = f(11) = dpois(11, 10) = 0.1137
dpois(11, 10) # = 0.1137364

##############
##### 5) #####
##############

# Dado que:
# X - Nº de chamadas telefónicas recebidas, num dia.
# X ~ P(5)
# E que se pretende calcular probabilidades sobre 4 dias, obtém-se:
# Y - Nº de chamadas telefónicas recebidas, em 4 dias.
# Y = X1 + X2 + X3 + X4
# λ = λX1 + λX2 + λX2 + λX4 = 5 + 5 + 5 + 5 = 20
# Y ~ P(20)

# P(Y = 12) = f(12) = dpois(12, 20) = 0.0176
dpois(12, 20) # = 0.01762517

########################################################
#################### Exercicio 2.24 ####################
########################################################

##############
##### 1) #####
##############

# X - Volume semanal de vendas, em milhares de litros.

# f(x) >= 0, ∀x ? ✓

# f(x) >= 0 x
# No ramo 0 <= x < 5, f(x) = 1/10 >= 0 ✓
# No ramo 5 <= x < 10, 0 <= f(x) <= 0.2, logo >= 0 ✓
# Caso contrário f(x) = 0 >= 0 ✓

# Σ ∫ [-∞, +∞] (f(x)) dx = 1 ? ✓

# ∫ [-∞, +∞] (f(x)) dx =
# ∫ [-∞, 0] (0) dx + ∫ [0, 5] (1/10) dx + ∫ [5, 10] ((10-x)/25) dx + ∫ [10, +∞] (0) dx =
# ∫ [0, 5] (1/10) dx + ∫ [5, 10] ((10-x)/25) dx =
# (1/10) * ∫ [0, 5] (1) dx + (10/25) * ∫ [5, 10] (1) dx - (1/25) * ∫ [5, 10] (x) dx =
# (1/10) * [x][0, 5] + (10/25) * [x][5, 10] - (1/25) * [x^2/2][5, 10] =
# (1/10) * (5 - 0) + (10/25) * (10 - 5) - (1/25) * (100/2 - 25/2) =
# (5/10) + (50/25) - (75/50) =
# (25/50) + (100/50) - (75/50) =
# (125/50) - (75/50) =
# (50/50) =
# 1 ✓

##############
##### 2) #####
##############

# F(x) = ?

# Ramos:
## x < 0
## 0 <= x < 5
## 5 <= x < 10
## x >= 10

## x < 0:
# ∫ [-∞, x] (f(t)) dt = 0

## 0 <= x < 5:
# ∫ [-∞, x] (f(t)) dt =
# F(0) + ∫ [0, x] (f(t)) dt =
# 0 + ∫ [0, x] (1/10) dt =
# (1/10) * ∫ [0, x] (1) dt =
# (1/10) * [t][0, x] =
# x/10

## 5 <= x < 10:
# ∫ [-∞, x] (f(t)) dt =
# F(5) + ∫ [5, x] (f(t)) dt =
# (5/10) + ∫ [5, x] ((10-x)/25) dt =
# (5/10) + ((10/25) * ∫ [5, x] (1) dt) - ((1/25) * ∫ [5, x] (t) dt) =
# (5/10) + ((10/25) * [t][5, x]) - ((1/25) * [t^2/2][5, x]) =
# (5/10) + ((10/25) * (x - 5)) - ((1/25) * ((x^2/2) - (25/2))) =
# (5/10) + ((10x/25) - (50/25)) - ((x^2/50) - (25/50)) =
# (5/10) + (10x/25) - (50/25) - (x^2/50) + (25/50) =
# (25/50) + (10x/25) - (100/50) - (x^2/50) + (25/50) =
# (10x/25) - (x^2/50) - (50/50)

## x >= 10:
# ∫ [-∞, x] (f(t)) dt =
# F(10) + ∫ [10, x] (f(t)) dt =
# ((100/25) - (100/50) - (50/50)) + 0 =
# ((200/50) - (150/50)) =
# (50/50) =
# 1

#        I 0                                , x < 0     
# F(x) = I (x/10)                           , 0 <= x < 5
#        I ((10x/25) - (x^2/50) - (50/50))  , 5 <= x < 10 
#        I 1                                , x >= 10

##############
##### 3) #####
##############

# P(X > 7 | X >= 4) =
# P(X > 7 ∧ X >= 4) / P(X >= 4) =
# P(X > 7) / (1 - P(X < 4)) =
# (1 - P(x <= 7)) / (1 - F(4)) =
# (1 - F(7)) / (1 - F(4)) =
# (1 - ((70/25) - (49/50) - (50/50))) / (1 - 4/10) =
# ((50/50) - (140/50) + (99/50)) / (6/10) =
# ((149/50) - (140/50)) / (6/10) =
# (9/50) / (6/10) =
# (9/50) * (10/6) =
# (90/300) =
# (9/30) =
# 0.3

##############
##### 4) #####
##############

# E[X] = ?

# E[X] = ∫ [-∞, +∞] (x * f(x)) dx =
# ∫[-∞, 0] (0x) dx +
#    ∫[0, 5] (x(1/10)) dx +
#    ∫[5, 10] (x((10-x)/25)) dx +
#    ∫[10, +∞] (0x) dx =
# ∫[0, 5] (x/10) dx + ∫[5, 10] ((10x-x^2)/25) dx =
# (1/10) * ∫[0, 5] (x) dx + (10/25) * ∫[5, 10] (x) dx - (1/25) * ∫[5, 10] (x^2) dx =
# (1/10) * [x^2/2][0, 5] + (10/25) * [x^2/2][5, 10] - (1/25) * [x^3/3][5, 10] =
# (1/10) * (25/2) + (10/25) * (25/2) - (1/25) * (125/3) =
# (25/20) + (250/50) - (125/75) =
# (25/20) + 5 - (125/75) =
# (25/20) + (375/75) - (125/75) =
# (25/20) + (250/75) =
# (1875/1500) + (5000/1500) =
# (6875/1500) =
# 4.5833

########################################################
#################### Exercicio 2.26 ####################
########################################################

##############
##### 1) #####
##############

# P(1/2 < X < 2 | X >= 3/2) =
# P(1/2 < X < 2 ∧ X >= 3/2) / P(X >= 3/2) =
# P(3/2 <= X < 2) / P(X >= 3/2) =
# (F(2) - F(3/2)) / (1 - F(3/2)) =
# (((2/12) + (3/4)) - (((3/2)/12) + (3/4))) /  (1 - (((3/2)/12) + (3/4))) =
# ((11/12) - (7/8)) / ( 1 - (7/8)) =
# ((88/96) - (84/96)) / (1/8) =
# (4/96) / (1/8) =
# 32/96 =
# 1/3 =
# 0.3333

##############
##### 2) #####
##############

# Ramos:
### -1 <= x < 0
### 0 <= x < 1
### 1 <= x < 3

### -1 <= x < 0:
# ((x^3/3) + (1/3))' = x^2
expr <- function (x) {
  ((x^3/3) + (1/3))
}
Deriv::Deriv(expr, "x")

### 0 <= x < 1:
# ((x^2/2) + (1/3))' = x
expr <- function (x) {
  ((x^2/2) + (1/3))
}
Deriv::Deriv(expr, "x")

### 1 <= x < 3:
# ((x/12) + (3/4))' = 1/12
expr <- function (x) {
  ((x/12) + (3/4))
}
Deriv::Deriv(expr, "x")
FRACTION::fra(0.0833333333333333)

#        I x^2   , -1 <= x < 0
# f(x) = I x     , 0 <= x < 1
#        I 1/12  , 1 <= x < 3
#        I 0     , C.C.

##############
##### 3) #####
##############

# E[X] = ?
# V[X] = ?

pdf_cust <- function (x) {
  ifelse(-1 <= x & x < 0, (x^2),
  ifelse(0 <= x & x < 1, (x),
  ifelse(1 <= x & x < 3, (1/12),
  0)))
}

media_ex_continuas <- function (x) {
  pdf_cust(x) * x
}

ex2_continuas <- function (x) {
  pdf_cust(x) * (x^2)
}

valor_ex_continuas <- function () {
  integrate(media_ex_continuas, lower = -Inf, upper = +Inf)$value
}

valor_vx_continuas <- function () {
  integrate(ex2_continuas, lower = -Inf, upper = +Inf)$value - integrate(media_ex_continuas, lower = -Inf, upper = +Inf)$value^2
}

# E[X]
valor_ex_continuas()

# V[X]
valor_vx_continuas()

##############
##### 4) #####
##############

# E[X + 2] = ?
# E[X^2 + 2] = ?
# V[1 - (X/2)] = ?

# E[X + 2] = E[X] + 2 = 2.4167
valor_ex_continuas() + 2

# E[X^2 + 2] = E[X^2] + 2 = 3.1722
integrate(ex2_continuas, lower = -Inf, upper = +Inf)$value + 2

# V[1 - (X/2)] = V[(X/2)] = (1/2)^2 * V[X] = 0.2497
valor_vx_continuas() * (1/2)^2

########################################################
#################### Exercicio 2.29 ####################
########################################################

# X - Tempo de vida de determinada componente, em horas.
# X ~ Exp(σ)
# P(X > 72) = 95% = 0.95

##############
##### 1) #####
##############

# P(X > 72) = 0.95 <=>
# 1 - P(X <= 72) = 0.95 <=>
# 1 - F(72) = 0.95 <=>
# 1 - (1 - e^(-72/σ)) = 0.95 <=>
# 1 - 1 + e^(-72/σ) = 0.95 <=>
# e^(-72/σ) = 0.95 <=>
# -72/σ = ln(0.95) <=>
# -72 = ln(0.95) * σ <=>
# σ = -72/ln(0.95) <=>
-72/log(0.95)
# σ = 1403.692

# X ~ Exp(1403.692)

##############
##### 2) #####
##############

# X ~ Exp(1404)

# P(X > 72 + 24 | X > 72) =    ---> Falta de Memória
# P(X >= 24) =
# 1 - P(X < 24) =
# 1 - F(24) =
# 1 - pexp(24, 1/1404) =
# 0.9831

########################################################
#################### Exercicio 2.30 ####################
########################################################

# X - Tempo necessário para reparar uma máquina, em horas.
# X ~ Exp(σ)
# σ = E[X] = 90min
# X ~ Exp(90)

##############
##### 1) #####
##############

# Y - Nº de máquinas reparadas, em 5 horas = 300 minutos.
# Y ~ P(λ)

# 1 reparação  ---------  90 minutos
# λ reparações --------- 300 minutos
# λ = 300/90 = 30/9 = 10/3

# Y ~ P(10/3)

# P(Y >= 3) =
# 1 - P(Y < 3) =
# 1 - P(Y <= 2) =
# 1 - F(2) =
# 1 - ppois(2, 10/3) =
# 0.6472

##############
##### 2) #####
##############

# P(x < 45) =
# F(45) =
# pexp(45, 1/90) =
# 0.3935

########################################################
#################### Exercicio 2.31 ####################
########################################################

# X - Nº de livros vendidos, numa hora.
# X ~ P(λ)
# λ = V[X] = E[X] = 2
# X ~ P(2)
# A livraria está aberta das 9h às 19h, todos os dias.

##############
##### 1) #####
##############

# P(X > 3) =
# 1 - P(X <= 3) =
# 1 - F(3) =
# 1 - ppois(3, 2) =
# 0.1429

##############
##### 2) #####
##############

# Y - Nº de livros vendidos, num dia (10 horas).
# Y ~ P(λ = 2 * 10)
# Y ~ P(20)

# P(Y >= 8) =
# 1 - P(Y < 8) =
# 1 - P(Y <= 7) =  --> V. A. Discreta
# 1 - F(7) =
# 1 - ppois(7, 20) =
# 0.9992

##############
##### 3) #####
##############

# Z - Tempo entre vendas sucessivas.
# Z ~ Exp(σ)

# 2 vendas --------- 1 hora
# 1 venda  --------- σ horas
# σ = 1/2 horas = 30 minutos

# Z ~ Exp(30)

# P(Z > 45) =
# 1 - P(Z <= 45) =
# 1 - F(45) =
# 1 - pexp(45, 1/30) =
# 0.2231

########################################################
#################### Exercicio 2.34 ####################
########################################################

# X - Peso de cada pacote, em gramas.
# X ~ U(a, b) => Uniforme Contínua
# E[X] = 505.4g

##############
##### 1) #####
##############

# P(X < 500) = 0.05 <=>
# F(500) = 0.05

# Função para calcular a probabilidade acumulada dado "a" e "b":
prob_acumulada <- function (a, b, x) {
  (x - a) / (b - a)
}

# Função para verificar se a diferença entre a probabilidade acumulada e
# a probabilidade conhecida está próxima o suficiente de zero:
verificar_prob <- function (a, media, x, prob_conhecida) {
  b <- 2 * media - a
  abs(prob_acumulada(a, b, x) - prob_conhecida)
}

# Função principal que inicializa e termina o processo:
calcular_limites_dominio_uniforme_continua <- function (media, x, prob_conhecida) {
  # Encontrando "a" e "b" utilizando otimização:
  result <- optimize(
    verificar_prob,
    interval = c(0, media),
    media = media,
    x = x,
    prob_conhecida = prob_conhecida
  )
  
  a <- result$minimum
  b <- 2 * media - a
  
  print(paste("Valor de a:", round(a, 4)))
  print(paste("Valor de b:", round(b, 4)))
}

calcular_limites_dominio_uniforme_continua(505.4, 500, 0.05)

# a = 499.4
# b = 511.4

# Dx = [499.4, 511.4]

##############
##### 2) #####
##############

# P(X > 500) =
# 1 - P(X <= 500) =
# 1 - F(500) =
# 1 - punif(500, 499.4, 511.4) =
# 0.95

##############
##### 3) #####
##############

# P(X < 510 | X > 505.4) =
# P(X < 510 ∧ X > 505.4) / P(X > 505.4) =
# P(505.4 < X < 510) / (1 - F(505.4)) =
# (F(510) - F(505.4)) / (1 - punif(505.4, 499.4, 511.4)) =
# (punif(510, 499.4, 511.4) - punif(505.4, 499.4, 511.4)) / 0.5 =
# 0.3833 / 0.5 =
# 0.7666

##############
##### 4) #####
##############

# Y - Pacote estar fora da validade.
# P(X = 1) = 0.1
# Y ~ B(1, 0.1)

# Z - Pacote estar fora da validade, em 20 pacotes.
# Z = Y*20 ~ B(1*20, 0.1)
# Z ~ B(20, 0.1)

# P(Z >= 2) =
# 1 - P (Z < 2) =
# 1 - P(Z <= 1) =
# 1 - F(1) =
# 1 - pbinom(1, 20, 0.1) =
# 0.6083

########################################################
#################### Exercicio 2.35 ####################
########################################################

# X - Espessura de foto-resistência das "wafers", em micrómetro.
# X ~ U(a, b) => Uniforme Contínua
# a = 0.2050
# b = 0.2150
# X ~ U(0.2050, 0.2150)
# Dx = [0.2050, 0.2150]

##############
##### 1) #####
##############

# P(X > E[X]) = ?

# E[X] = (a + b) / 2 = (0.2050 + 0.2150) / 2 = 0.21

# P(X > 0.21) =
# 1 - P(X <= 0.21) =
# 1 - F(0.21) =
# 1 - punif(0.21, 0.2050, 0.2150) =
# 0.5

##############
##### 2) #####
##############

# P(X <= k) = 95% <=>
# P(X <= k) = 0.95 <=>
# F(k) = 0.95 <=>
# k = F^-1(0.95) <=>
# k = qunif(0.95, 0.2050, 0.2150) <=>
# k = 0.2145

##############
##### 3) #####
##############

# P(X > k) = 10% <=>
# P(X > k) = 0.1 <=>
# 1 - P(X <= k) = 0.1 <=>
# 1 - 0.1 = P(X <= k) <=>
# F(k) = 0.9 <=>
# k = F^-1(0.9) <=>
# k = qunif(0.9, 0.2050, 0.2150) <=>
# k = 0.214

##############
##### 4) #####
##############

# σ = √(V[X])
# V[X] = (b - a)^2 / 12 = (0.2150 - 0.2050)^2 / 12 = 8.333333e-06
# σ = √(V[X]) = sqrt(8.333333e-06) = 0.0029

########################################################
#################### Exercicio 2.36 ####################
########################################################

# X - Espessura de chapas, em cm.
# X ~ U(a, b) => Uniforme Contínua
# a = 0.84
# b = 1.04
# X ~ U(0.84, 1.04)
# Dx = [0.84, 1.04]

##############
##### 1) #####
##############

# Para uma delas:
# P(X > 1) =
# 1 - P(X <= 1) =
# 1 - F(1) =
# 1 - punif(1, 0.84, 1.04) =
# 0.2

# Para as 250 Analisadas:
# 250 * 0.2 = 50

##############
##### 2) #####
##############

# P(X < k) = 40% <=>
# P(X < k) = 0.4 <=>
# F(k) = 0.4 <=>
# k = F^1(0.4) <=>
# k = qunif(0.4, 0.84, 1.04) <=>
# k = 0.92cm
